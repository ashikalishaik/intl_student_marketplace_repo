{% extends "base.html" %}
{% block title %}Admin - Orders{% endblock %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h1 class="h4 mb-0">Orders</h1>
    <div class="small text-muted">All user order history (admin view).</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-6 col-md-4">
    <input name="buyer_id" class="form-control" placeholder="Filter by buyer id" value="{{ request.args.get('buyer_id','') }}">
  </div>
  <div class="col-auto">
    <button class="btn btn-outline-dark">Filter</button>
    <a class="btn btn-outline-secondary" href="{{ url_for('admin.orders_list') }}">Clear</a>
  </div>
</form>

<div class="table-responsive">
  <table class="table table-sm align-middle">
    <thead>
      <tr>
        <th>#</th>
        <th>Buyer</th>
        <th>Total</th>
        <th>Status</th>
        <th>Created</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for o in orders %}
      <tr>
        <td><a href="{{ url_for('admin.order_detail', order_id=o.id) }}">{{ o.id }}</a></td>
        <td>
          {% if o.buyer %}
            {{ o.buyer.name }} <span class="text-muted">(#{{ o.buyer_id }})</span>
          {% else %}
            <span class="text-muted">#{{ o.buyer_id }}</span>
          {% endif %}
        </td>
        <td>${{ "%.2f"|format(o.total_amount) }}</td>
        <td><span class="badge text-bg-light border">{{ o.status }}</span></td>
        <td class="text-muted">{{ o.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
        <td class="text-end">
          <a class="btn btn-outline-dark btn-sm" href="{{ url_for('admin.order_detail', order_id=o.id) }}">View</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="text-muted">No orders found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
